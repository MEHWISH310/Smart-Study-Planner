<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Progress - Smart Study Planner</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #00BFFF; /* Sky Blue */
            --secondary: #FF69B4; /* Pink */
            --accent: #FFEB3B; /* Lemon Yellow */
            --light: #FFFFFF; /* White */
            --dark: #212529;
            --success: #4ade80;
            --warning: #f59e0b;
            --danger: #ef4444;
            --gray: #6c757d;
            --card-bg: rgba(255, 255, 255, 0.95);
            --text: #333;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        .dark-mode {
            --primary: #00BFFF;
            --secondary: #4a1bc5;
            --accent: #5fd4f8;
            --light: #1a1a1a;
            --dark: #f8f9fa;
            --card-bg: rgba(30, 30, 30, 0.95);
            --text: #f0f0f0;
            --shadow: rgba(255, 255, 255, 0.05);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            background: linear-gradient(135deg, #00BFFF 0%, #FF69B4 100%);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body.dark-mode {
            background: linear-gradient(135deg, #23628d 0%, #8e3a64 100%);
        }

        /* Floating Background Objects */
        .floating-objects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .floating-object {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 15s infinite linear;
        }

        .floating-object:nth-child(1) {
            width: 80px;
            height: 80px;
            top: 10%;
            left: 10%;
            animation-duration: 20s;
        }

        .floating-object:nth-child(2) {
            width: 120px;
            height: 120px;
            top: 60%;
            left: 80%;
            animation-duration: 25s;
        }

        .floating-object:nth-child(3) {
            width: 60px;
            height: 60px;
            top: 80%;
            left: 20%;
            animation-duration: 15s;
        }

        .floating-object:nth-child(4) {
            width: 100px;
            height: 100px;
            top: 30%;
            left: 70%;
            animation-duration: 30s;
        }

        .floating-object:nth-child(5) {
            width: 70px;
            height: 70px;
            top: 50%;
            left: 40%;
            animation-duration: 18s;
        }

        @keyframes float {
            0% {
                transform: translate(0, 0) rotate(0deg);
            }
            25% {
                transform: translate(20px, 40px) rotate(90deg);
            }
            50% {
                transform: translate(40px, 0) rotate(180deg);
            }
            75% {
                transform: translate(20px, -40px) rotate(270deg);
            }
            100% {
                transform: translate(0, 0) rotate(360deg);
            }
        }

        /* Header Styles */
        header {
            background-color: var(--card-bg);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }

        .logo {
            width: 80px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo img {
            width: 100%;
            height: auto;
            border-radius: 10%;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .nav-links a {
            color: var(--text);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .nav-links a:hover {
            background-color: var(--primary);
            color: white;
        }

        .nav-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .theme-toggle {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 500;
        }

        .theme-toggle:hover {
            background: var(--secondary);
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }

        .page-title {
            text-align: center;
            margin-bottom: 2rem;
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px var(--shadow);
            backdrop-filter: blur(10px);
            min-height: 300px;
        }

        .card-full {
            grid-column: 1 / -1;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .dark-mode .card-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
        }

        /* Task Stats */
        .task-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .stat-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 1rem;
            flex: 1;
            min-width: 150px;
            text-align: center;
            box-shadow: 0 2px 4px var(--shadow);
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        /* Progress Insights */
        .insights-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }

        .insight-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 4px var(--shadow);
        }

        .insight-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .insight-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .insight-description {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Priority Indicators */
        .priority-high {
            color: var(--danger);
            font-weight: 600;
        }

        .priority-medium {
            color: var(--warning);
            font-weight: 600;
        }

        .priority-low {
            color: var(--success);
            font-weight: 600;
        }

        /* Progress Bar */
        .progress-bar {
            height: 10px;
            background-color: rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .dark-mode .progress-bar {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary);
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 2rem;
            color: var(--gray);
        }

        /* Footer */
        footer {
            background-color: var(--card-bg);
            backdrop-filter: blur(10px);
            padding: 2rem 2rem 1rem;
            margin-top: 1rem;
            box-shadow: 0 -4px 6px var(--shadow);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            align-items: flex-start;
            gap: 2rem;
        }

        .footer-section {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .footer-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-logo .logo img {
            width: 70px;
            height: auto;
            margin-bottom: 0;
        }

        .footer-logo .logo-text {
            font-size: 1.6rem;
            font-weight: 700;
            line-height: 1.2;
        }

        .footer-about {
            line-height: 1.6;
            color: var(--gray);
            max-width: 400px;
        }

        .footer-heading {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .footer-links {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .footer-links a {
            color: var(--text);
            text-decoration: none;
            transition: color 0.2s;
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        .footer-contact p {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-bottom {
            max-width: 1200px;
            margin: 2rem auto 0;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .dark-mode .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .copyright {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .social-links {
            display: flex;
            gap: 1rem;
        }

        .social-links a {
            color: var(--text);
            font-size: 1.2rem;
            transition: color 0.2s;
            text-decoration: none;
        }

        .social-links a:hover {
            color: var(--primary);
        }

        .btn-outline {
            background-color: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
            border: 2px solid var(--primary);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary:hover {
            background-color: var(--secondary);
        }

        .nav-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
            }
            
            .footer-bottom {
                flex-direction: column;
                text-align: center;
            }
            
            .task-stats {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Floating Background Objects -->
    <div class="floating-objects">
        <div class="floating-object"></div>
        <div class="floating-object"></div>
        <div class="floating-object"></div>
        <div class="floating-object"></div>
        <div class="floating-object"></div>
    </div>

    <!-- Header -->
    <header>
        <a href="index.html" class="logo-container">
            <div class="logo"><img src="logo.png" alt="Smart Study Planner Logo"></div>
            <div class="logo-text">Smart Study Planner</div>
        </a>
        <nav class="nav-links">
            <a href="index.html">Dashboard</a>
            <a href="about.html">About Us</a>
            <a href="tasks.html">My Tasks</a>
            <a href="goals.html">Study Goals</a>
            <a href="resources.html">Resources</a>
            <a href="progress.html" style="background-color: var(--primary); color: white;">Progress</a>
        </nav>
        <div class="nav-controls">
            <a href="login.html" class="btn btn-outline" id="loginBtn">Login</a>
            <a href="signup.html" class="btn btn-primary" id="signupBtn">Sign Up</a>
            <button class="theme-toggle" id="themeToggle">
                <span id="themeIcon">ðŸŒ™</span> <span id="themeText">Dark Mode</span>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <h1 class="page-title">Your Progress</h1>
        
        <!-- Task Statistics -->
        <div class="task-stats">
            <div class="stat-card">
                <div class="stat-number" id="totalTasks">0</div>
                <div class="stat-label">Total Tasks</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completedTasks">0</div>
                <div class="stat-label">Completed</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completionRate">0%</div>
                <div class="stat-label">Completion Rate</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="overdueTasks">0</div>
                <div class="stat-label">Overdue</div>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- Task Completion Chart -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Task Completion</h2>
                </div>
                <div class="chart-container">
                    <canvas id="completionChart"></canvas>
                </div>
            </div>

            <!-- Priority Distribution -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Priority Distribution</h2>
                </div>
                <div class="chart-container">
                    <canvas id="priorityChart"></canvas>
                </div>
            </div>

            <!-- Subject Performance -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Subject Performance</h2>
                </div>
                <div class="chart-container">
                    <canvas id="subjectChart"></canvas>
                </div>
            </div>

            <!-- Weekly Progress -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Weekly Progress</h2>
                </div>
                <div class="chart-container">
                    <canvas id="weeklyChart"></canvas>
                </div>
            </div>

            <!-- Progress Insights -->
            <div class="card card-full">
                <div class="card-header">
                    <h2 class="card-title">Progress Insights</h2>
                </div>
                <div class="insights-container" id="insightsContainer">
                    <!-- Insights will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <div class="footer-logo">
                    <div class="logo"><img src="logo.png" alt="Smart Study Planner Logo"></div>
                    <div class="logo-text">Smart Study Planner</div>
                </div>
                <p class="footer-about">
                    Smart Study Planner is an innovative tool designed to help students organize their academic life efficiently. 
                    With intuitive task management, progress tracking, and smart reminders, our platform empowers students to 
                    achieve their academic goals while maintaining a healthy study-life balance.
                </p>
            </div>
            
            <div class="footer-section">
                <h3 class="footer-heading">Quick Links</h3>
                <div class="footer-links">
                    <a href="about.html">About Us</a>
                    <a href="features.html">Features</a>
                    <a href="pricing.html">Pricing</a>
                    <a href="testimonials.html">Testimonials</a>
                    <a href="blog.html">Blog</a>
                </div>
            </div>
            
            <div class="footer-section">
                <h3 class="footer-heading">Resources</h3>
                <div class="footer-links">
                    <a href="studytips.html">Study Tips</a>
                    <a href="time.html">Time Management</a>
                    <a href="productivity.html">Productivity Tools</a>
                    <a href="academic.html">Academic Resources</a>
                    <a href="support.html">Support Center</a>
                </div>
            </div>
            
            <div class="footer-section">
                <h3 class="footer-heading">Contact Us</h3>
                <div class="footer-contact">
                    <p><i class="fas fa-envelope"></i> info@smartstudyplanner.com</p>
                    <p><i class="fas fa-phone"></i> +1 (555) 123-4567</p>
                    <p><i class="fas fa-map-marker-alt"></i> 123 Education Street, Learning City</p>
                </div>
                <div class="social-links">
                    <a href="www.facebook.com" title="Facebook"><i class="fab fa-facebook"></i></a>
                    <a href="www.twitter.com" title="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="www.instagram.com" title="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="www.linkedin.com" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            <div class="copyright">
                &copy; 2025 Smart Study Planner. All rights reserved.
            </div>
            <div class="footer-links">
                <a href="privacy.html">Privacy Policy</a>
                <a href="terms.html">Terms of Service</a>
                <a href="cookie.html">Cookie Policy</a>
            </div>
        </div>
    </footer>

    <script>
        // DOM Elements
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const themeText = document.getElementById('themeText');
        const totalTasksElement = document.getElementById('totalTasks');
        const completedTasksElement = document.getElementById('completedTasks');
        const completionRateElement = document.getElementById('completionRate');
        const overdueTasksElement = document.getElementById('overdueTasks');
        const insightsContainer = document.getElementById('insightsContainer');

        // Chart instances
        let completionChart, priorityChart, subjectChart, weeklyChart;

        // Theme Toggle
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            if (document.body.classList.contains('dark-mode')) {
                themeIcon.textContent = 'â˜€ï¸';
                themeText.textContent = 'Light Mode';
            } else {
                themeIcon.textContent = 'ðŸŒ™';
                themeText.textContent = 'Dark Mode';
            }
            saveToLocalStorage('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
            
            // Update charts for theme change
            updateCharts();
        });

        // Load saved theme
        const savedTheme = getFromLocalStorage('theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
            themeIcon.textContent = 'â˜€ï¸';
            themeText.textContent = 'Light Mode';
        }

        // Load and display progress data
        function loadProgressData() {
            const tasks = getFromLocalStorage('tasks') || [];
            updateStats(tasks);
            updateCharts(tasks);
            generateInsights(tasks);
        }

        // Update statistics
        function updateStats(tasks) {
            const total = tasks.length;
            const completed = tasks.filter(task => task.completed).length;
            const overdue = tasks.filter(task => !task.completed && isOverdue(task.deadline)).length;
            const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
            
            totalTasksElement.textContent = total;
            completedTasksElement.textContent = completed;
            completionRateElement.textContent = `${completionRate}%`;
            overdueTasksElement.textContent = overdue;
        }

        // Update charts
        function updateCharts(tasks = getFromLocalStorage('tasks') || []) {
            // Task Completion Chart
            const completionCtx = document.getElementById('completionChart').getContext('2d');
            const completedTasks = tasks.filter(task => task.completed).length;
            const pendingTasks = tasks.length - completedTasks;
            
            if (completionChart) {
                completionChart.destroy();
            }
            
            completionChart = new Chart(completionCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Completed', 'Pending'],
                    datasets: [{
                        data: [completedTasks, pendingTasks],
                        backgroundColor: [
                            'rgba(74, 222, 128, 0.8)',
                            'rgba(251, 191, 36, 0.8)'
                        ],
                        borderColor: [
                            'rgba(74, 222, 128, 1)',
                            'rgba(251, 191, 36, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: getComputedStyle(document.body).getPropertyValue('--text')
                            }
                        }
                    }
                }
            });

            // Priority Distribution Chart
            const priorityCtx = document.getElementById('priorityChart').getContext('2d');
            const highPriority = tasks.filter(task => task.priority === 'high').length;
            const mediumPriority = tasks.filter(task => task.priority === 'medium').length;
            const lowPriority = tasks.filter(task => task.priority === 'low').length;
            
            if (priorityChart) {
                priorityChart.destroy();
            }
            
            priorityChart = new Chart(priorityCtx, {
                type: 'pie',
                data: {
                    labels: ['High', 'Medium', 'Low'],
                    datasets: [{
                        data: [highPriority, mediumPriority, lowPriority],
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(245, 158, 11, 0.8)',
                            'rgba(74, 222, 128, 0.8)'
                        ],
                        borderColor: [
                            'rgba(239, 68, 68, 1)',
                            'rgba(245, 158, 11, 1)',
                            'rgba(74, 222, 128, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: getComputedStyle(document.body).getPropertyValue('--text')
                            }
                        }
                    }
                }
            });

            // Subject Performance Chart
            const subjectCtx = document.getElementById('subjectChart').getContext('2d');
            const subjects = [...new Set(tasks.map(task => task.subject))];
            const subjectData = subjects.map(subject => {
                const subjectTasks = tasks.filter(task => task.subject === subject);
                const completed = subjectTasks.filter(task => task.completed).length;
                return {
                    subject,
                    completed,
                    total: subjectTasks.length,
                    rate: subjectTasks.length > 0 ? Math.round((completed / subjectTasks.length) * 100) : 0
                };
            });
            
            if (subjectChart) {
                subjectChart.destroy();
            }
            
            subjectChart = new Chart(subjectCtx, {
                type: 'bar',
                data: {
                    labels: subjectData.map(item => item.subject),
                    datasets: [{
                        label: 'Completion Rate (%)',
                        data: subjectData.map(item => item.rate),
                        backgroundColor: 'rgba(0, 191, 255, 0.7)',
                        borderColor: 'rgba(0, 191, 255, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                color: getComputedStyle(document.body).getPropertyValue('--text')
                            },
                            grid: {
                                color: getComputedStyle(document.body).getPropertyValue('--shadow')
                            }
                        },
                        x: {
                            ticks: {
                                color: getComputedStyle(document.body).getPropertyValue('--text')
                            },
                            grid: {
                                color: getComputedStyle(document.body).getPropertyValue('--shadow')
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: getComputedStyle(document.body).getPropertyValue('--text')
                            }
                        }
                    }
                }
            });

            // Weekly Progress Chart
            const weeklyCtx = document.getElementById('weeklyChart').getContext('2d');
            const last7Days = Array.from({length: 7}, (_, i) => {
                const date = new Date();
                date.setDate(date.getDate() - i);
                return date.toISOString().split('T')[0];
            }).reverse();
            
            const weeklyData = last7Days.map(date => {
                return tasks.filter(task => {
                    const taskDate = task.completedAt ? task.completedAt.split('T')[0] : null;
                    return taskDate === date;
                }).length;
            });
            
            if (weeklyChart) {
                weeklyChart.destroy();
            }
            
            weeklyChart = new Chart(weeklyCtx, {
                type: 'line',
                data: {
                    labels: last7Days.map(date => formatDate(date)),
                    datasets: [{
                        label: 'Tasks Completed',
                        data: weeklyData,
                        backgroundColor: 'rgba(255, 105, 180, 0.2)',
                        borderColor: 'rgba(255, 105, 180, 1)',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: getComputedStyle(document.body).getPropertyValue('--text')
                            },
                            grid: {
                                color: getComputedStyle(document.body).getPropertyValue('--shadow')
                            }
                        },
                        x: {
                            ticks: {
                                color: getComputedStyle(document.body).getPropertyValue('--text')
                            },
                            grid: {
                                color: getComputedStyle(document.body).getPropertyValue('--shadow')
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: getComputedStyle(document.body).getPropertyValue('--text')
                            }
                        }
                    }
                }
            });
        }

        // Generate insights
        function generateInsights(tasks) {
            insightsContainer.innerHTML = '';
            
            if (tasks.length === 0) {
                insightsContainer.innerHTML = '<div class="empty-state">No tasks available. Add some tasks to see your progress insights!</div>';
                return;
            }
            
            const totalTasks = tasks.length;
            const completedTasks = tasks.filter(task => task.completed).length;
            const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
            
            // Most productive subject
            const subjects = [...new Set(tasks.map(task => task.subject))];
            const subjectCompletion = subjects.map(subject => {
                const subjectTasks = tasks.filter(task => task.subject === subject);
                const completed = subjectTasks.filter(task => task.completed).length;
                return {
                    subject,
                    rate: subjectTasks.length > 0 ? Math.round((completed / subjectTasks.length) * 100) : 0
                };
            });
            
            const mostProductiveSubject = subjectCompletion.reduce((prev, current) => 
                (prev.rate > current.rate) ? prev : current
            );
            
            // Priority completion rates
            const highPriorityTasks = tasks.filter(task => task.priority === 'high');
            const highPriorityCompleted = highPriorityTasks.filter(task => task.completed).length;
            const highPriorityRate = highPriorityTasks.length > 0 ? 
                Math.round((highPriorityCompleted / highPriorityTasks.length) * 100) : 0;
            
            // Overdue tasks
            const overdueTasks = tasks.filter(task => !task.completed && isOverdue(task.deadline));
            
            // Recent completion streak
            const today = new Date().toISOString().split('T')[0];
            const yesterday = new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            const todayCompleted = tasks.filter(task => 
                task.completedAt && task.completedAt.split('T')[0] === today
            ).length;
            const yesterdayCompleted = tasks.filter(task => 
                task.completedAt && task.completedAt.split('T')[0] === yesterday
            ).length;
            
            const streak = (todayCompleted > 0 && yesterdayCompleted > 0) ? 2 : 
                          (todayCompleted > 0 || yesterdayCompleted > 0) ? 1 : 0;
            
            // Create insight cards
            const insights = [
                {
                    title: "Overall Completion",
                    value: `${completionRate}%`,
                    description: `You've completed ${completedTasks} out of ${totalTasks} tasks.`
                },
                {
                    title: "Most Productive Subject",
                    value: mostProductiveSubject.subject,
                    description: `You have a ${mostProductiveSubject.rate}% completion rate in ${mostProductiveSubject.subject}.`
                },
                {
                    title: "High Priority Completion",
                    value: `${highPriorityRate}%`,
                    description: `You've completed ${highPriorityCompleted} out of ${highPriorityTasks.length} high priority tasks.`
                },
                {
                    title: "Tasks Needing Attention",
                    value: overdueTasks.length,
                    description: `${overdueTasks.length} tasks are overdue and need your immediate attention.`
                },
                {
                    title: "Current Streak",
                    value: `${streak} day${streak !== 1 ? 's' : ''}`,
                    description: streak > 0 ? 
                        "Keep up the good work! You're on a completion streak." : 
                        "Complete a task today to start a new streak!"
                },
                {
                    title: "Average Daily Completion",
                    value: calculateAverageDailyCompletion(tasks),
                    description: "This is how many tasks you complete on average each day."
                }
            ];
            
            insights.forEach(insight => {
                const insightCard = document.createElement('div');
                insightCard.className = 'insight-card';
                insightCard.innerHTML = `
                    <div class="insight-title">${insight.title}</div>
                    <div class="insight-value">${insight.value}</div>
                    <div class="insight-description">${insight.description}</div>
                `;
                insightsContainer.appendChild(insightCard);
            });
        }

        // Utility functions
        function isOverdue(deadline) {
            return new Date(deadline) < new Date();
        }

        function formatDate(dateString) {
            const options = { 
                month: 'short', 
                day: 'numeric' 
            };
            return new Date(dateString).toLocaleDateString('en-US', options);
        }

        function saveToLocalStorage(key, value) {
            localStorage.setItem(key, JSON.stringify(value));
        }

        function getFromLocalStorage(key) {
            const item = localStorage.getItem(key);
            return item ? JSON.parse(item) : null;
        }

        function calculateAverageDailyCompletion(tasks) {
            const completedTasks = tasks.filter(task => task.completed);
            if (completedTasks.length === 0) return 0;
            
            // Get the date of the first completed task
            const firstCompletion = new Date(Math.min(
                ...completedTasks.map(task => new Date(task.completedAt || task.createdAt))
            ));
            
            const today = new Date();
            const daysDiff = Math.ceil((today - firstCompletion) / (1000 * 60 * 60 * 24));
            const days = Math.max(daysDiff, 1); // At least 1 day
            
            return (completedTasks.length / days).toFixed(1);
        }

        // Initialize the page
        loadProgressData();
        
        // Listen for storage changes to update the page when tasks are modified
        window.addEventListener('storage', function(e) {
            if (e.key === 'tasks') {
                loadProgressData();
            }
        });
        
        // Also update when the page becomes visible again (in case of changes in other tabs)
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                loadProgressData();
            }
        });
    </script>
</body>
</html>